var b=!0,p=null,r=!1,t=0,u=1;function v(a,c,d){return"rgba("+(a|0)+","+(c|0)+","+(d|0)+",1)"}var w;a:{for(var aa=["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame"],x=0;x<aa.length;++x){var ba=aa[x];if(window[ba]){w=window[ba];break a}}w=function(a){var c=(new Date).getTime(),c=c-c%17+17-c;5>c&&(c=17);window.setTimeout(function(){a.call(window,(new Date).getTime())},c)}}
var ca=Math.max(320,256),y,z,A,da,B,C,D,E=0,ea,F,fa,G,H,I,ga=0,J=0,K=0,ha=10,L=1050,ia=9,ja=9,M=32768,ka=[{j:255,h:255,e:255},{j:255,h:64,e:128},{j:255,h:255,e:255},{j:96,h:240,e:255}],N,O,Q,la,R,S,T,ma,na,U,oa,pa,qa,ra,sa,ta,V=[],ua=[function(a,c,d){z.fillStyle="#000000";z.fillRect(0,0,640,512);z.textAlign="center";z.textBaseline="top";2!=a&&z.scale(-0.5,1);switch(a){case 0:a=4300<=c?(4700-c)/400:1;z.fillStyle=v(187*a,170*a,170*a);1E3<=c&&(z.font="50px sans-serif",z.fillText("PRESENTED",-640,40));
1800<=c&&(z.font="50px sans-serif",z.fillText("A T",-640,110));2100<=c&&(z.font="50px sans-serif",z.fillText("THE",-768,180));2800<=c&&(z.font="50px sans-serif",z.fillText("WORLD",-544,180));3600<=c&&(z.font="40px sans-serif",z.fillText("O F",-640,270));3900<=c&&(z.font="100px sans-serif",z.fillText("NOSTRADAMUS",-640,360));break;case 1:a=3300<=c?(3700-c)/400:1;z.fillStyle=v(153*a,136*a,136*a);z.font="50px sans-serif";z.fillText("SO",-736,40);800<=c&&(z.font="50px sans-serif",z.fillText("JUST",-576,
40));1100<=c&&(z.fillStyle=v(187*a,170*a,170*a),z.font="bold 100px sans-serif",z.fillText("Straight",-640,120));2E3<=c&&(z.font="50px sans-serif",z.fillText("OFF",-640,260));2650<=c&&(z.font="50px sans-serif",z.fillText("THE",-640,310));2950<=c&&(z.font="bold 120px sans-serif",z.fillText("tricycle",-640,360));break;case 2:z.globalAlpha=0.5<d?2-2*d:0.05>d?20*d:1,z.drawImage(G,320-(G.width>>1),256-(G.height>>1))}},function(a,c,d,e){z.fillStyle="#240000";z.fillRect(0,0,640,512);d=320+ca*A[M];for(var g=
256+ca*A[(M+16384)%65536],f=0==a?800*A[32768*c/4E3&65535]:J,j=0==a?0:ia,h=0==a?0:ja;h>=j;--h){var l=50+100*h+f,k=0==a?1:1-(l-50)/1E3,n=1-(l-L-50)/1E3;1<n&&(n=1);var m=ka[h>=ha?(h+ga)%4:0],va=320*n+d*(1-n),n=256*n+g*(1-n);z.beginPath();for(var q=0;65536>=q;q+=256){var s=320*(1+0.3*A[10*q%65536]),P=va+100/l*s*A[(q+K)%65536],s=n+100/l*s*A[(q+16384+K)%65536];q?z.lineTo(P,s):z.moveTo(P,s)}for(q=65536;0<=q;q-=4096)s=320,P=va+100/l*s*A[(q+K)%65536],s=n+100/l*s*A[(q+16384+K)%65536],z.lineTo(P,s);z.closePath();
z.fillStyle="rgba("+(m.j*k+36*(1-k)).toFixed(0)+","+(m.h*k).toFixed(0)+","+(m.e*k).toFixed(0)+",1)";z.fill()}for(d=J-9*e;0>d;)++ga,d+=100,2<=a&&0<ha&&--ha,1<=a&&0<ia&&--ia,3==a&&c>16E3-1E3*(1050/9)/60&&--ja;J=d|0;K=K+65536-473*e&65535;3==a&&(0<L?L-=9*e:(L=0,M=M+65536-100*e&65535))},function(a,c,d){R||(R=z.createImageData(512,384));a=R.data;var e=la.data;z.fillStyle="#350000";z.fillRect(0,0,640,50);z.fillRect(0,462,640,50);z.fillStyle="#46051e";z.fillRect(0,50,640,14);z.fillRect(0,448,640,14);for(var g=
0,f=784384,j=0;160>j;++j){for(var h=192/(192-j),l=255/h,k=(j*h+c/10)%Q&255,n=-256;256>n;++n){var m=n*h;-256>m||256<m?(a[g++]=0,a[g++]=0,a[g++]=0,a[g++]=255,a[f++]=0,a[f++]=0,a[f++]=0,a[f++]=255):(m=4*(k*O+((m+256>>2)%20&255)),a[g++]=e[m],a[f++]=e[m++],a[g++]=e[m],a[f++]=e[m++],a[g++]=e[m],a[f++]=e[m++],a[g++]=l,a[f++]=l)}f-=4096}z.putImageData(R,64,64);z.fillStyle="#998888";z.font="30px sans-serif";z.textAlign="center";z.textBaseline="center";z.fillText("To do: Finish bitmap tunnel effect",320,256);
z.font="20px sans-serif";z.fillText(((c/d-c)/1E3).toFixed(1)+" seconds to go",320,286)},function(a,c,d){var e=19*c+1E4;z.fillStyle="#441010";z.fillRect(0,0,640,512);c=160*A[e&65535];var g=160*A[e+32768&65535],f=A[e+16384&65535],e=-f,j=2/(2-f),h=2/(2-e);c*=j;var g=g*h,l=H.width,k=H.height,n=I.width,m=I.height;switch(a){case 0:z.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=l*j;d=k*j;z.drawImage(H,320+c-a/2,256-d/2,a,d);break;case 1:z.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=n*j;d=m*j;0<f&&z.drawImage(H,320-l/
2,256-k/2);z.drawImage(I,320+c-a/2,256-d/2,a,d);0>=f&&z.drawImage(H,320-l/2,256-k/2);break;case 2:z.globalAlpha=0.1>d?10*d:0.9>d?1:10-10*d,a=l*j,d=k*j,f=n*h,h*=m,0<e&&z.drawImage(H,320+c-a/2,256-d/2,a,d),z.drawImage(I,320+g-f/2,256-h/2,f,h),0>=e&&z.drawImage(H,320+c-a/2,256-d/2,a,d)}},function(a,c,d){z.fillStyle="#110000";z.fillRect(0,0,640,512);a=U.width;var e=U.height;z.drawImage(U,320-a,256-e,2*a,2*e);a=ma.data;for(var e=144*A[23*c&65535]+256-112|0,g=144*A[17*c&65535]+256-112|0,f=0,j=0;223>=j;++j)for(var h=
0;223>=h;++h){var l=0;a[f++]=255;a[f++]=255;a[f++]=255;var k=na[h];0<k&&(k=((j-112)/k|0)+112,0<=k&&223>=k&&(l=pa[512*(k+g)+h+e]?128:0));a[f++]=l}T.clearRect(0,0,224,224);T.putImageData(ma,0,0);z.drawImage(S,96,32,448,448);512>c&&(z.fillStyle="#441000",z.fillRect(0,0,640,256-c/2),z.fillRect(0,256+c/2,640,256-c/2));0.95<d&&(z.fillStyle="rgba(0,0,0,"+(20*d-19).toFixed(3)+")",z.fillRect(0,0,640,512))},function(a,c,d){z.fillStyle="#000000";z.fillRect(0,0,640,512);a=V[a];var e=a.i,g=e.width*a.scale,f=e.height*
a.scale;z.drawImage(e,320-(g>>1),256-(f>>1),g,f);500>c?(z.globalAlpha=1-c/500,z.fillStyle=a.f,z.fillRect(0,0,640,512)):(c=c/d-c,500>c&&(z.globalAlpha=1-c/500,z.fillStyle=a.g,z.fillRect(0,0,640,512)))},function(a,c,d){z.fillStyle="#000073";z.fillRect(0,0,640,512);100<c&&(a=c/d-c,z.fillStyle="#ffffff",z.font="30px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText("This scene is not yet implemented...",320,256),z.font="20px sans-serif",z.fillText((a/1E3).toFixed(1)+" seconds to next implemented scene",
320,296))}],wa=[{a:0,b:4700,c:0,d:0},{a:4700,b:8400,c:0,d:1},{a:8400,b:9500,c:0,d:2},{a:9500,b:4E4,c:2,d:0},{a:4E4,b:44E3,c:5,d:0},{a:44E3,b:48E3,c:5,d:1},{a:48E3,b:52E3,c:3,d:0},{a:52E3,b:56E3,c:3,d:1},{a:56E3,b:63300,c:3,d:2},{a:63300,b:82500,c:4,d:0},{a:82500,b:92500,c:5,d:2},{a:92500,b:97500,c:5,d:3},{a:97500,b:128500,c:6,d:0},{a:128500,b:132500,c:1,d:0},{a:132500,b:139500,c:1,d:1},{a:139500,b:147E3,c:1,d:2},{a:147E3,b:163E3,c:1,d:3},{a:163E3,b:188E3,c:6,d:0},r];
function xa(a){if(C){u=60*((a-B)/1E3);t=a-C;var c=wa[E];c&&t>=c.b&&(++E,c=wa[E]);if(c){var d=t-c.a,e=d/(c.b-c.a);ea=ua[c.c];var g=(new Date).getTime();z.globalAlpha=1;z.save();ea.call(this,c.d,d,e,u);z.restore()}c=(22-((new Date).getTime()-g)-10*u)/200;0<c&&(c*=0.005);c=da+c;1<c?c=1:0.1>c&&(c=0.1);da=c}D&&(B||(C=a-1E3*D),B=a);F&&w(xa)}function ya(){F=b;w(xa)}function za(){D=this.currentTime}var W=[],X=0;
function Aa(a){W.push(a);++X;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.k=X-W.length;window.dispatchEvent(a)}function Ba(a){for(var c=[],d=0;d<W.length;++d)W[d]!=a&&c.push(W[d]);W=c;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.k=X-W.length;window.dispatchEvent(a)}var Y=p;function Ca(){Y&&window.clearTimeout(Y);var a=this;Y=window.setTimeout(function(){Y=p;a.removeEventListener("progress",Ca,r);Ba(a)},2E3)}
function Da(){Y&&(window.clearTimeout(Y),Y=p);this.removeEventListener("progress",Ca,r);Ba(this)}function Ea(){Ba(this)}function Z(a){var c=new Image;Aa(c);c.addEventListener("load",Ea,r);c.src=a;return c}var $=p;
onLoadingDone=function(){$&&(window.clearTimeout($),$=p);for(var a=[],c=4*Math.atan(1),d=0;65535>=d;++d)a.push(Math.sin(d*c/32768));A=a;S=document.createElement("CANVAS");S.width=S.height=224;T=S.getContext("2d");ma=T.createImageData(224,224);c=[];for(a=0;224>=a;++a)c.push(Math.sin(Math.acos(a/112-1)));na=c;a=document.createElement("CANVAS");a.width=512;a.height=512;a=a.getContext("2d");a.clearRect(0,0,512,512);a.drawImage(oa,0,0);c=a.getImageData(0,0,512,512).data;pa=Array(262144);for(var e=d=0;512>
e;++e)for(a=0;512>a;++a)pa[d]=128<c[4*d],++d;V.push({f:"#ffffff",g:"#000000",i:qa,scale:2});V.push({f:"#000000",g:"#441010",i:ra,scale:2});V.push({f:"#ffffff",g:"#000000",i:sa,scale:2});V.push({f:"#000000",g:"#000000",i:ta,scale:2});O=N.width;Q=N.height;a=document.createElement("CANVAS");a.width=O;a.height=Q;a=a.getContext("2d");a.drawImage(N,0,0,O,Q);la=a.getImageData(0,0,O,Q);fa.play()};
onItemsLoader=function(a){$&&(window.clearTimeout($),$=p);z.fillStyle="#000000";z.fillRect(0,0,640,512);z.fillStyle="#ffffff";a.k==a.total?(z.font="50px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText("Loading done!",320,256),z.font="20px sans-serif",z.fillText("Click to start...",320,296),window.setTimeout(onLoadingDone,10),y.addEventListener("click",onLoadingDone,r)):(z.font="30px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText("Loading...",320,256),z.font=
"20px sans-serif",z.fillText((100*(a.k/a.total)).toFixed(0)+" % done",320,296))};
onload=function(){y=document.getElementById("demo");z=y.getContext("2d");F=r;window.addEventListener("itemsLoader",onItemsLoader,r);var a=document.createElement("AUDIO");a.controls=b;a.l="auto";Aa(a);a.addEventListener("play",ya,r);a.addEventListener("timeupdate",za,r);a.addEventListener("progress",Ca,r);a.addEventListener("canplay",Da,r);var c=a.canPlayType("audio/ogg"),d=a.canPlayType("audio/mpeg");if("probably"==c||"maybe"==c&&"probably"!=d)a.src="livin-insanity.ogg";else if("probably"==d||"maybe"==
d)a.src="livin-insanity.mp3";a.load();fa=a;G=Z("whaaaaat.png");H=Z("biteArte.png");I=Z("deadChicken.png");U=Z("globe.png");oa=Z("globeDoodles.png");qa=Z("sanity1.png");ra=Z("madman.png");N=Z("tunnelBits.png");sa=Z("einstein.png");ta=Z("sanity2.png")};window.onload=onload;
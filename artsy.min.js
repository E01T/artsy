var b=!0,n=null,q=!1,s=Math.random,v=0,w=1;function x(a,c,d){return"rgba("+(a|0)+","+(c|0)+","+(d|0)+",1)"}var y;a:{for(var aa=["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame"],A=0;A<aa.length;++A){var ba=aa[A];if(window[ba]){y=window[ba];break a}}y=function(a){var c=(new Date).getTime(),c=c-c%17+17-c;5>c&&(c=17);window.setTimeout(function(){a.call(window,(new Date).getTime())},c)}}
for(var ca=4*Math.atan(1),da=Math.max(320,256),ea,B,C,fa,ga,ha,ia,ja=0,ka,la,ma,D,E,F,na=0,oa=0,G=0,pa=10,H=1050,qa=9,ra=9,I=32768,sa=[{n:255,l:255,i:255},{n:255,l:64,i:128},{n:255,l:255,i:255},{n:96,l:240,i:255}],J,K,L,ta,M,ua,va,N,O,P,wa,xa,Q,ya,za,Aa,Ba,Ca,Da,R=[],Ea=[{a:31,b:0,c:481,d:0},{a:481,b:0,c:440,d:460},{a:440,b:460,c:256,d:511},{a:256,b:511,c:71,d:460},{a:71,b:460,c:31,d:0},{a:256,b:37,c:440,d:37},{a:440,b:37,c:405,d:431},{a:405,b:431,c:256,d:472},{a:256,b:472,c:256,d:413},{a:256,b:355,
c:256,d:264},{a:256,b:208,c:256,d:150},{a:256,b:94,c:256,d:37},{a:114,b:94,c:397,d:94},{a:397,b:94,c:391,d:150},{a:391,b:150,c:175,d:150},{a:175,b:150,c:180,d:208},{a:180,b:208,c:386,d:208},{a:386,b:208,c:371,d:381},{a:371,b:381,c:256,d:413},{a:256,b:413,c:140,d:381},{a:140,b:381,c:132,d:293},{a:132,b:293,c:188,d:293},{a:188,b:293,c:192,d:338},{a:192,b:338,c:256,d:355},{a:256,b:355,c:318,d:338},{a:318,b:338,c:325,d:264},{a:325,b:264,c:129,d:264},{a:129,b:264,c:114,d:94}],Fa=[],S=0,Ga=0,T=80,U=0,Ha=
b;10<T;){var V=Ea[S],Ia=Math.sqrt((V.c-V.a)*(V.c-V.a)+(V.d-V.b)*(V.d-V.b)),U=Ha&&0==U?0.1:0==U?T/2:U+T;if(U>Ia)U=0,S=(S+1)%Ea.length,0==S&&(Ha?Ha=q:T/=2);else{var Ja=V.a-256+U/Ia*(V.c-V.a);Fa.push({x:Ja,y:V.b-256+U/Ia*(V.d-V.b),p:0.1*Math.abs(Ja)});++Ga}}for(var Ka=[],La=0;1E3>La;++La)Ka.push({x:1024*s()-512,y:1024*s()-512,p:1024*s()-512});function Ma(a){return 512<a?a-1024*Math.floor((a+512)/1024):-512>a?a+1024*Math.floor((512-a)/1024):a}
var Na=[function(a,c,d){B.fillStyle="#000000";B.fillRect(0,0,640,512);B.textAlign="center";B.textBaseline="top";2!=a&&B.scale(-0.5,1);switch(a){case 0:a=4300<=c?(4700-c)/400:1;B.fillStyle=x(187*a,170*a,170*a);1E3<=c&&(B.font="50px sans-serif",B.fillText("PRESENTED",-640,40));1800<=c&&(B.font="50px sans-serif",B.fillText("A T",-640,110));2100<=c&&(B.font="50px sans-serif",B.fillText("THE",-768,180));2800<=c&&(B.font="50px sans-serif",B.fillText("WORLD",-544,180));3600<=c&&(B.font="40px sans-serif",
B.fillText("O F",-640,270));3900<=c&&(B.font="100px sans-serif",B.fillText("NOSTRADAMUS",-640,360));break;case 1:a=3300<=c?(3700-c)/400:1;B.fillStyle=x(153*a,136*a,136*a);B.font="50px sans-serif";B.fillText("SO",-736,40);800<=c&&(B.font="50px sans-serif",B.fillText("JUST",-576,40));1100<=c&&(B.fillStyle=x(187*a,170*a,170*a),B.font="bold 100px sans-serif",B.fillText("Straight",-640,120));2E3<=c&&(B.font="50px sans-serif",B.fillText("OFF",-640,260));2650<=c&&(B.font="50px sans-serif",B.fillText("THE",
-640,310));2950<=c&&(B.font="bold 120px sans-serif",B.fillText("tricycle",-640,360));break;case 2:B.globalAlpha=0.25<d?4/3-4*(d/3):0.1>d?10*d:1,B.drawImage(D,320-(D.width>>1),256-(D.height>>1))}},function(a,c,d,g){B.fillStyle="#240000";B.fillRect(0,0,640,512);d=320+da*C[I];for(var j=256+da*C[(I+16384)%65536],e=0==a?800*C[32768*c/4E3&65535]:oa,k=0==a?0:qa,h=0==a?0:ra;h>=k;--h){var m=50+100*h+e,l=0==a?1:1-(m-50)/1E3,f=1-(m-H-50)/1E3;1<f&&(f=1);var p=sa[h>=pa?(h+na)%4:0],z=320*f+d*(1-f),f=256*f+j*(1-
f);B.beginPath();for(var r=0;65536>=r;r+=256){var t=320*(1+0.3*C[10*r%65536]),u=z+100/m*t*C[(r+G)%65536],t=f+100/m*t*C[(r+16384+G)%65536];r?B.lineTo(u,t):B.moveTo(u,t)}for(r=65536;0<=r;r-=4096)t=320,u=z+100/m*t*C[(r+G)%65536],t=f+100/m*t*C[(r+16384+G)%65536],B.lineTo(u,t);B.closePath();B.fillStyle="rgba("+(p.n*l+36*(1-l)).toFixed(0)+","+(p.l*l).toFixed(0)+","+(p.i*l).toFixed(0)+",1)";B.fill()}for(d=oa-9*g;0>d;)++na,d+=100,2<=a&&0<pa&&--pa,1<=a&&0<qa&&--qa,3==a&&c>16E3-1E3*(1050/9)/60&&--ra;oa=d|0;
G=G+65536-473*g&65535;3==a&&(0<H?H-=9*g:(H=0,I=I+65536-100*g&65535))},function(a,c){var d=va.data,g=ta.data;B.fillStyle="#350000";B.fillRect(0,0,640,50);B.fillRect(0,462,640,50);B.fillStyle="#46051e";B.fillRect(0,50,640,14);B.fillRect(0,448,640,14);B.fillStyle="#000000";B.fillRect(0,64,640,384);var j=0,e=244480,k,h=0;4E3>c?k=0:1E4>c?(k=0.2,h=(6E3-c)/4):12E3>c?(k=(12E3-c)/1E4,h=0):18E3>c?(k=-0.2,h=(14E3-c)/4):2E4>c?(k=(c-2E4)/1E4,h=0):26E3>c?(k=0.2,h=(22E3-c)/4):28E3>c?(k=(28E3-c)/1E4,h=0):k=0;0>h&&
(h=0);for(var m=0;64>m;++m){var l=64/(64-m),f=m*l;if(500>f)var p=f+c/4,z=255/l,r=f>h?(f-h)*k:0,f=p/L/4&255,f=0<=f?N[f]:q,p=p%L&255;else f=q;for(var t=-160;160>t;++t){var u=(t+r)*l;-160>u||160<u||f===q||void 0===f?(d[j++]=d[j++]=d[j++]=0,d[j++]=255,d[e++]=d[e++]=d[e++]=0,d[e++]=255):(u=4*(p*K+((u+160>>1)%20&4095)+f),d[j++]=d[e++]=g[u++],d[j++]=d[e++]=g[u++],d[j++]=d[e++]=g[u++],d[j++]=d[e++]=z)}e-=2560}ua.putImageData(va,0,0);B.drawImage(M,0,64,640,384);B.fillStyle="#998888";B.font="30px sans-serif";
B.textAlign="center";B.textBaseline="center";B.fillText("To do: Finish bitmap tunnel effect",320,256)},function(a,c,d){var g=19*c+1E4;B.fillStyle="#441010";B.fillRect(0,0,640,512);c=160*C[g&65535];var j=160*C[g+32768&65535],e=C[g+16384&65535],g=-e,k=2/(2-e),h=2/(2-g);c*=k;var j=j*h,m=E.width,l=E.height,f=F.width,p=F.height;switch(a){case 0:B.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=m*k;d=l*k;B.drawImage(E,320+c-a/2,256-d/2,a,d);break;case 1:B.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=f*k;d=p*k;0<e&&B.drawImage(E,
320-m/2,256-l/2);B.drawImage(F,320+c-a/2,256-d/2,a,d);0>=e&&B.drawImage(E,320-m/2,256-l/2);break;case 2:B.globalAlpha=0.1>d?10*d:0.9>d?1:10-10*d,a=m*k,d=l*k,e=f*h,h*=p,0<g&&B.drawImage(E,320+c-a/2,256-d/2,a,d),B.drawImage(F,320+j-e/2,256-h/2,e,h),0>=g&&B.drawImage(E,320+c-a/2,256-d/2,a,d)}},function(a,c,d){B.fillStyle="#110000";B.fillRect(0,0,640,512);a=Q.width;var g=Q.height;B.drawImage(Q,320-a,256-g,2*a,2*g);a=wa.data;for(var g=144*C[23*c&65535]+256-112|0,j=144*C[17*c&65535]+256-112|0,e=0,k=0;223>=
k;++k)for(var h=0;223>=h;++h){var m=0;a[e++]=255;a[e++]=255;a[e++]=255;var l=xa[h];0<l&&(l=((k-112)/l|0)+112,0<=l&&223>=l&&(m=za[512*(l+j)+h+g]?128:0));a[e++]=m}P.clearRect(0,0,224,224);P.putImageData(wa,0,0);B.drawImage(O,96,32,448,448);512>c&&(B.fillStyle="#441000",B.fillRect(0,0,640,256-c/2),B.fillRect(0,256+c/2,640,256-c/2));0.95<d&&(B.fillStyle="rgba(0,0,0,"+(20*d-19).toFixed(3)+")",B.fillRect(0,0,640,512))},function(a,c,d){B.fillStyle="#000000";B.fillRect(0,0,640,512);a=R[a];var g=a.m,j=g.width*
a.scale,e=g.height*a.scale;B.drawImage(g,320-(j>>1),256-(e>>1),j,e);500>c?(B.globalAlpha=1-c/500,B.fillStyle=a.j,B.fillRect(0,0,640,512)):(c=c/d-c,500>c&&(B.globalAlpha=1-c/500,B.fillStyle=a.k,B.fillRect(0,0,640,512)))},function(a,c,d){var g=1;0.95<d&&(g=20*(1-d));B.fillStyle="#000000";B.fillRect(0,0,640,512);var j,e,k,h,m,l;switch(a){case 0:j=Fa;e=k=h=0;m=1024-2048*d;l=c/4;break;case 1:j=Ka,m=0,l=c/4,e=0,6E3<c?e=1:2E3<c&&(e=(1-Math.cos((c-2E3)/4E3*ca))/2),h=-c/10+3072*e*C[5*c+3E4&65535],k=4096*e*
C[4*c+54E3&65535],e=18E3<c?1:14E3<c?(1-Math.cos((c-14E3)/4E3*ca))/2:0,e=3072*e*C[3*(c-14E3)&65535]}l>j.length&&(l=j.length);B.fillStyle="#ffffff";for(a=0;a<l;++a){var f=j[a],p=Ma(f.x+e);d=Ma(f.y+k);f=Ma(f.p+h);f+=m;if(-1E3<f&&1E3>f){var z=512/(f+1024),p=320+z*p;d=256+z*d;0<p&&(640>p&&0<d&&512>d)&&(B.globalAlpha=(1E3-f)/2E3*g,B.fillRect(p,d,2,2))}}c-=15100;if(0<=c&&(g=c/480/8|0,240>(c%480|0)))switch(B.globalAlpha=1,B.textAlign="left",B.textBaseline="top",g){case 0:B.fillStyle="#999999";B.font="40px sans-serif";
B.fillText("Anders Tornblad",10,10);B.fillStyle="#666666";B.font="30px sans-serif";B.fillText("JavaScript",10,55);break;case 1:B.fillStyle="#999999";B.font="40px sans-serif";B.fillText("Olivi\u00e9r Bechard (RA)",10,10);B.fillStyle="#666666";B.font="30px sans-serif";B.fillText("graphics",10,55);break;case 2:B.fillStyle="#999999",B.font="40px sans-serif",B.fillText("Fr\u00e9d\u00e9ric Motte (Moby)",10,10),B.fillStyle="#666666",B.font="30px sans-serif",B.fillText("music",10,55)}},function(a,c,d){B.fillStyle=
"#000073";B.fillRect(0,0,640,512);100<c&&(a=c/d-c,B.fillStyle="#ffffff",B.font="30px sans-serif",B.textAlign="center",B.textBaseline="middle",B.fillText("This scene is not yet implemented...",320,256),B.font="20px sans-serif",B.fillText((a/1E3).toFixed(1)+" seconds to next implemented scene",320,296))}],Oa=[{e:0,f:4700,g:0,h:0},{e:4700,f:8400,g:0,h:1},{e:8400,f:9500,g:0,h:2},{e:9500,f:4E4,g:2,h:0},{e:4E4,f:44E3,g:5,h:0},{e:44E3,f:48E3,g:5,h:1},{e:48E3,f:52E3,g:3,h:0},{e:52E3,f:56E3,g:3,h:1},{e:56E3,
f:63300,g:3,h:2},{e:63300,f:82500,g:4,h:0},{e:82500,f:9E4,g:5,h:2},{e:9E4,f:94E3,g:5,h:3},{e:94E3,f:98E3,g:6,h:0},{e:98E3,f:128500,g:6,h:1},{e:128500,f:132500,g:1,h:0},{e:132500,f:139500,g:1,h:1},{e:139500,f:147E3,g:1,h:2},{e:147E3,f:163E3,g:1,h:3},{e:163E3,f:188E3,g:7,h:0},q];
function Pa(a){if(ha){w=60*((a-ga)/1E3);v=a-ha;var c=Oa[ja];c&&v>=c.f&&(++ja,c=Oa[ja]);if(c){var d=v-c.e,g=d/(c.f-c.e);ka=Na[c.g];var j=(new Date).getTime();B.globalAlpha=1;B.save();ka.call(this,c.h,d,g,w);B.restore()}c=(22-((new Date).getTime()-j)-10*w)/200;0<c&&(c*=0.005);c=fa+c;1<c?c=1:0.1>c&&(c=0.1);fa=c}ia&&(ga||(ha=a-1E3*ia),ga=a);la&&y(Pa)}function Qa(){la=b;y(Pa)}function Ra(){ia=this.currentTime}var W=[],X=0;
function Sa(a){W.push(a);++X;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.o=X-W.length;window.dispatchEvent(a)}function Ta(a){for(var c=[],d=0;d<W.length;++d)W[d]!=a&&c.push(W[d]);W=c;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.o=X-W.length;window.dispatchEvent(a)}var Y=n;function Ua(){Y&&window.clearTimeout(Y);var a=this;Y=window.setTimeout(function(){Y=n;a.removeEventListener("progress",Ua,q);Ta(a)},2E3)}
function Va(){Y&&(window.clearTimeout(Y),Y=n);this.removeEventListener("progress",Ua,q);Ta(this)}function Wa(){Ta(this)}function Z(a){var c=new Image;Sa(c);c.addEventListener("load",Wa,q);c.src=a;return c}var $=n;
onLoadingDone=function(){$&&(window.clearTimeout($),$=n);for(var a=[],c=4*Math.atan(1),d=0;65535>=d;++d)a.push(Math.sin(d*c/32768));C=a;O=document.createElement("CANVAS");O.width=O.height=224;P=O.getContext("2d");wa=P.createImageData(224,224);c=[];for(a=0;224>=a;++a)c.push(Math.sin(Math.acos(a/112-1)));xa=c;a=document.createElement("CANVAS");a.width=512;a.height=512;a=a.getContext("2d");a.clearRect(0,0,512,512);a.drawImage(ya,0,0);c=a.getImageData(0,0,512,512).data;za=Array(262144);for(var g=d=0;512>
g;++g)for(a=0;512>a;++a)za[d]=128<c[4*d],++d;R.push({j:"#ffffff",k:"#000000",m:Aa,scale:2});R.push({j:"#000000",k:"#441010",m:Ba,scale:2});R.push({j:"#ffffff",k:"#000000",m:Ca,scale:2});R.push({j:"#000000",k:"#000000",m:Da,scale:2});K=J.width;L=J.height;a=document.createElement("CANVAS");a.width=K;a.height=L;a=a.getContext("2d");a.drawImage(J,0,0,K,L);ta=a.getImageData(0,0,K,L);M=document.createElement("CANVAS");M.width=320;M.height=192;ua=M.getContext("2d");va=ua.createImageData(320,192);N=[];for(a=
0;77>a;++a)c="    aaa bbb ccaaddddbbbbaaaacccc aaabbbdddbbbccc aa bbddddccccddbbbbabbbbcccc"[a]," "==c?N.push(q):N.push(20*(c.charCodeAt(0)-97));ma.play()};
onItemsLoader=function(a){$&&(window.clearTimeout($),$=n);B.fillStyle="#000000";B.fillRect(0,0,640,512);B.fillStyle="#ffffff";a.o==a.total?(B.font="50px sans-serif",B.textAlign="center",B.textBaseline="middle",B.fillText("Loading done!",320,256),B.font="20px sans-serif",B.fillText("Click to start...",320,296),window.setTimeout(onLoadingDone,10),ea.addEventListener("click",onLoadingDone,q)):(B.font="30px sans-serif",B.textAlign="center",B.textBaseline="middle",B.fillText("Loading...",320,256),B.font=
"20px sans-serif",B.fillText((100*(a.o/a.total)).toFixed(0)+" % done",320,296))};
onload=function(){ea=document.getElementById("demo");B=ea.getContext("2d");la=q;window.addEventListener("itemsLoader",onItemsLoader,q);var a=document.createElement("AUDIO");a.controls=b;a.q="auto";Sa(a);a.addEventListener("play",Qa,q);a.addEventListener("timeupdate",Ra,q);a.addEventListener("progress",Ua,q);a.addEventListener("canplay",Va,q);var c=a.canPlayType("audio/ogg"),d=a.canPlayType("audio/mpeg");if("probably"==c||"maybe"==c&&"probably"!=d)a.src="livin-insanity.ogg";else if("probably"==d||
"maybe"==d)a.src="livin-insanity.mp3";a.load();ma=a;D=Z("whaaaaat.png");E=Z("biteArte.png");F=Z("deadChicken.png");Q=Z("globe.png");ya=Z("globeDoodles.png");Aa=Z("sanity1.png");Ba=Z("madman.png");J=Z("tunnelBits.png");Ca=Z("einstein.png");Da=Z("sanity2.png")};window.onload=onload;
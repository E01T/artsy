var b=!0,m=null,u=!1,v=Math.random,w=0,aa=1;function ba(a,c,d){return"rgba("+(a|0)+","+(c|0)+","+(d|0)+",1)"}var x;a:{for(var ca=["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame"],da=0;da<ca.length;++da){var ea=ca[da];if(window[ea]){x=window[ea];break a}}x=function(a){var c=(new Date).getTime(),c=c-c%17+17-c;5>c&&(c=17);window.setTimeout(function(){a.call(window,(new Date).getTime())},c)}}var fa=4*Math.atan(1),ga=Math.max(320,256);
function y(a){return(1-Math.cos(a*fa))/2}
for(var ha,z,A,ia,ja,ka,la,ma=0,na,oa,pa,B,C,D,qa=0,ra=0,E=0,sa=10,F=1050,ta=9,ua=9,G=32768,va=[{p:255,n:255,k:255},{p:255,n:64,k:128},{p:255,n:255,k:255},{p:96,n:240,k:255}],H,I,J,wa,K,xa,ya,L,M,N,za,Aa,O,Ba,Ca,Da,Ea,Fa,Ga,Q=[],Ha=[{b:31,c:0,d:481,e:0},{b:481,c:0,d:440,e:460},{b:440,c:460,d:256,e:511},{b:256,c:511,d:71,e:460},{b:71,c:460,d:31,e:0},{b:256,c:37,d:440,e:37},{b:440,c:37,d:405,e:431},{b:405,c:431,d:256,e:472},{b:256,c:472,d:256,e:413},{b:256,c:355,d:256,e:264},{b:256,c:208,d:256,e:150},
{b:256,c:94,d:256,e:37},{b:114,c:94,d:397,e:94},{b:397,c:94,d:391,e:150},{b:391,c:150,d:175,e:150},{b:175,c:150,d:180,e:208},{b:180,c:208,d:386,e:208},{b:386,c:208,d:371,e:381},{b:371,c:381,d:256,e:413},{b:256,c:413,d:140,e:381},{b:140,c:381,d:132,e:293},{b:132,c:293,d:188,e:293},{b:188,c:293,d:192,e:338},{b:192,c:338,d:256,e:355},{b:256,c:355,d:318,e:338},{b:318,c:338,d:325,e:264},{b:325,c:264,d:129,e:264},{b:129,c:264,d:114,e:94}],Ia=[],R=0,Ja=0,S=80,T=0,Ka=b;10<S;){var U=Ha[R],La=Math.sqrt((U.d-
U.b)*(U.d-U.b)+(U.e-U.c)*(U.e-U.c)),T=Ka&&0==T?0.1:0==T?S/2:T+S;if(T>La)T=0,R=(R+1)%Ha.length,0==R&&(Ka?Ka=u:S/=2);else{var Ma=U.b-256+T/La*(U.d-U.b);Ia.push({x:Ma,y:U.c-256+T/La*(U.e-U.c),r:0.1*Math.abs(Ma)});++Ja}}for(var Na=[],Oa=0;1E3>Oa;++Oa)Na.push({x:1024*v()-512,y:1024*v()-512,r:1024*v()-512});function Pa(a){return 512<a?a-1024*Math.floor((a+512)/1024):-512>a?a+1024*Math.floor((512-a)/1024):a}
var Qa,Ra,V,Sa,Ta,Ua,Va,Wa=[{a:0,x:78,y:0,j:131,i:81},{a:800,x:0,y:91,j:69,i:22},{a:1200,x:85,y:91,j:216,i:22},{a:2100,x:63,y:119,j:91,i:22},{a:2700,x:170,y:119,j:76,i:22},{a:2900,x:74,y:148,j:154,i:28},{a:3100,x:21,y:181,j:93,i:22},{a:3400,x:128,y:181,j:151,i:23}],Xa=[{a:0,x:67,y:0,j:70,i:16},{a:800,x:10,y:34,j:48,i:18},{a:1100,x:0,y:53,j:60,i:35},{a:1100,x:63,y:41,j:45,i:47},{a:1900,x:119,y:46,j:84,i:36},{a:2300,x:6,y:102,j:216,i:43},{a:2900,x:41,y:154,j:128,i:100}],Ya=[function(a,c,d){z.fillStyle=
"#000000";z.fillRect(0,0,640,512);z.textAlign="center";z.textBaseline="top";2!=a&&z.scale(-0.5,1);switch(a){case 0:a=4300<=c?(4700-c)/400:1;z.fillStyle=ba(187*a,170*a,170*a);1E3<=c&&(z.font="50px sans-serif",z.fillText("PRESENTED",-640,40));1800<=c&&(z.font="50px sans-serif",z.fillText("A T",-640,110));2100<=c&&(z.font="50px sans-serif",z.fillText("THE",-768,180));2800<=c&&(z.font="50px sans-serif",z.fillText("WORLD",-544,180));3600<=c&&(z.font="40px sans-serif",z.fillText("O F",-640,270));3900<=
c&&(z.font="100px sans-serif",z.fillText("NOSTRADAMUS",-640,360));break;case 1:a=3300<=c?(3700-c)/400:1;z.fillStyle=ba(153*a,136*a,136*a);z.font="50px sans-serif";z.fillText("SO",-736,40);800<=c&&(z.font="50px sans-serif",z.fillText("JUST",-576,40));1100<=c&&(z.fillStyle=ba(187*a,170*a,170*a),z.font="bold 100px sans-serif",z.fillText("Straight",-640,120));2E3<=c&&(z.font="50px sans-serif",z.fillText("OFF",-640,260));2650<=c&&(z.font="50px sans-serif",z.fillText("THE",-640,310));2950<=c&&(z.font="bold 120px sans-serif",
z.fillText("tricycle",-640,360));break;case 2:z.globalAlpha=0.25<d?4/3-4*(d/3):0.1>d?10*d:1,z.drawImage(B,320-(B.width>>1),256-(B.height>>1))}},function(a,c,d,f){z.fillStyle="#240000";z.fillRect(0,0,640,512);d=320+ga*A[G];for(var k=256+ga*A[(G+16384)%65536],e=0==a?800*A[32768*c/4E3&65535]:ra,h=0==a?0:ta,j=0==a?0:ua;j>=h;--j){var n=50+100*j+e,l=0==a?1:1-(n-50)/1E3,g=1-(n-F-50)/1E3;1<g&&(g=1);var r=va[j>=sa?(j+qa)%4:0],t=320*g+d*(1-g),g=256*g+k*(1-g);z.beginPath();for(var q=0;65536>=q;q+=256){var p=
320*(1+0.3*A[10*q%65536]),s=t+100/n*p*A[(q+E)%65536],p=g+100/n*p*A[(q+16384+E)%65536];q?z.lineTo(s,p):z.moveTo(s,p)}for(q=65536;0<=q;q-=4096)p=320,s=t+100/n*p*A[(q+E)%65536],p=g+100/n*p*A[(q+16384+E)%65536],z.lineTo(s,p);z.closePath();z.fillStyle="rgba("+(r.p*l+36*(1-l)).toFixed(0)+","+(r.n*l).toFixed(0)+","+(r.k*l).toFixed(0)+",1)";z.fill()}for(d=ra-9*f;0>d;)++qa,d+=100,2<=a&&0<sa&&--sa,1<=a&&0<ta&&--ta,3==a&&c>16E3-1E3*(1050/9)/60&&--ua;ra=d|0;E=E+65536-473*f&65535;3==a&&(0<F?F-=9*f:(F=0,G=G+65536-
100*f&65535))},function(a,c){var d=ya.data,f=wa.data;z.fillStyle="#350000";z.fillRect(0,0,640,50);z.fillRect(0,462,640,50);z.fillStyle="#46051e";z.fillRect(0,50,640,14);z.fillRect(0,448,640,14);z.fillStyle="#000000";z.fillRect(0,64,640,384);var k=0,e=244480,h,j=0;4E3>c?h=0:1E4>c?(h=0.2,j=(6E3-c)/4):12E3>c?(h=(12E3-c)/1E4,j=0):18E3>c?(h=-0.2,j=(14E3-c)/4):2E4>c?(h=(c-2E4)/1E4,j=0):26E3>c?(h=0.2,j=(22E3-c)/4):28E3>c?(h=(28E3-c)/1E4,j=0):h=0;0>j&&(j=0);for(var n=0;64>n;++n){var l=64/(64-n),g=n*l;if(500>
g)var r=g+c/4,t=255/l,q=g>j?(g-j)*h:0,g=r/J/4&255,g=0<=g?L[g]:u,r=r%J&255;else g=u;for(var p=-160;160>p;++p){var s=(p+q)*l;-160>s||160<s||g===u||void 0===g?(d[k++]=d[k++]=d[k++]=0,d[k++]=255,d[e++]=d[e++]=d[e++]=0,d[e++]=255):(s=4*(r*I+((s+160>>1)%20&4095)+g),d[k++]=d[e++]=f[s++],d[k++]=d[e++]=f[s++],d[k++]=d[e++]=f[s++],d[k++]=d[e++]=t)}e-=2560}xa.putImageData(ya,0,0);z.drawImage(K,0,64,640,384);z.fillStyle="#998888";z.font="30px sans-serif";z.textAlign="center";z.textBaseline="center";z.fillText("To do: Finish bitmap tunnel effect",
320,256)},function(a,c,d){var f=19*c+1E4;z.fillStyle="#441010";z.fillRect(0,0,640,512);c=160*A[f&65535];var k=160*A[f+32768&65535],e=A[f+16384&65535],f=-e,h=2/(2-e),j=2/(2-f);c*=h;var k=k*j,n=C.width,l=C.height,g=D.width,r=D.height;switch(a){case 0:z.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=n*h;d=l*h;z.drawImage(C,320+c-a/2,256-d/2,a,d);break;case 1:z.globalAlpha=0.2>d?5*d:0.8>d?1:5-5*d;a=g*h;d=r*h;0<e&&z.drawImage(C,320-n/2,256-l/2);z.drawImage(D,320+c-a/2,256-d/2,a,d);0>=e&&z.drawImage(C,320-n/2,256-
l/2);break;case 2:z.globalAlpha=0.1>d?10*d:0.9>d?1:10-10*d,a=n*h,d=l*h,e=g*j,j*=r,0<f&&z.drawImage(C,320+c-a/2,256-d/2,a,d),z.drawImage(D,320+k-e/2,256-j/2,e,j),0>=f&&z.drawImage(C,320+c-a/2,256-d/2,a,d)}},function(a,c,d){z.fillStyle="#110000";z.fillRect(0,0,640,512);a=O.width;var f=O.height;z.drawImage(O,320-a,256-f,2*a,2*f);a=za.data;for(var f=144*A[23*c&65535]+256-112|0,k=144*A[17*c&65535]+256-112|0,e=0,h=0;223>=h;++h)for(var j=0;223>=j;++j){var n=0;a[e++]=255;a[e++]=255;a[e++]=255;var l=Aa[j];
0<l&&(l=((h-112)/l|0)+112,0<=l&&223>=l&&(n=Ca[512*(l+k)+j+f]?128:0));a[e++]=n}N.clearRect(0,0,224,224);N.putImageData(za,0,0);z.drawImage(M,96,32,448,448);512>c&&(z.fillStyle="#441000",z.fillRect(0,0,640,256-c/2),z.fillRect(0,256+c/2,640,256-c/2));0.95<d&&(z.fillStyle="rgba(0,0,0,"+(20*d-19).toFixed(3)+")",z.fillRect(0,0,640,512))},function(a,c,d){z.fillStyle="#000000";z.fillRect(0,0,640,512);a=Q[a];var f=a.o,k=f.width*a.scale,e=f.height*a.scale;z.drawImage(f,320-(k>>1),256-(e>>1),k,e);500>c?(z.globalAlpha=
1-c/500,z.fillStyle=a.l,z.fillRect(0,0,640,512)):(c=c/d-c,500>c&&(z.globalAlpha=1-c/500,z.fillStyle=a.m,z.fillRect(0,0,640,512)))},function(a,c,d){var f=1;0.95<d&&(f=20*(1-d));z.fillStyle="#000000";z.fillRect(0,0,640,512);var k,e,h,j,n,l;switch(a){case 0:k=Ia;e=h=j=0;n=1024-2048*d;l=c/4;break;case 1:k=Na,n=0,l=c/4,e=0,6E3<c?e=1:2E3<c&&(e=y((c-2E3)/4E3)),j=-c/10+2048*e*A[5*c+3E4&65535],h=1024*e*A[2*c+54E3&65535],e=18E3<c?1:14E3<c?y((c-14E3)/4E3):0,e=3072*e*A[3*(c-14E3)&65535]}l>k.length&&(l=k.length);
z.fillStyle="#ffffff";for(a=0;a<l;++a){var g=k[a],r=Pa(g.x+e);d=Pa(g.y+h);g=Pa(g.r+j);g+=n;if(-1E3<g&&1E3>g){var t=512/(g+1024),r=320+t*r;d=256+t*d;0<r&&(640>r&&0<d&&512>d)&&(z.globalAlpha=(1E3-g)/2E3*f,z.fillRect(r,d,2,2))}}c-=15100;if(0<=c&&(f=c/480/8|0,240>(c%480|0)))switch(z.globalAlpha=1,z.textAlign="left",z.textBaseline="top",f){case 0:z.fillStyle="#999999";z.font="40px sans-serif";z.fillText("Anders Tornblad",10,10);z.fillStyle="#666666";z.font="30px sans-serif";z.fillText("JavaScript",10,
55);break;case 1:z.fillStyle="#999999";z.font="40px sans-serif";z.fillText("Olivi\u00e9r Bechard (RA)",10,10);z.fillStyle="#666666";z.font="30px sans-serif";z.fillText("graphics",10,55);break;case 2:z.fillStyle="#999999",z.font="40px sans-serif",z.fillText("Fr\u00e9d\u00e9ric Motte (Moby)",10,10),z.fillStyle="#666666",z.font="30px sans-serif",z.fillText("music",10,55)}},function(a,c,d){z.fillStyle="#000000";z.fillRect(0,0,640,512);a=65536*A[65536*y(d)&65535];c=196608*y(d);for(var f=0.7>d?0.25:3.75*
y((d-0.7)/0.3)+0.25,k=80*A[c&65535]+50,e=72*A[c+23E3&65535],h=50*A[a&65535]+70,j=Ra.data,n=Ta.data,l=0,g=0;100>g;++g)for(var r=0;100>r;++r){var t=g-50,q=r-50,p=t*A[a+16384&65535]+q*A[a&65535],s=q*A[a+16384&65535]-t*A[a&65535],s=s-k,p=p-e,p=p/1,s=s/1,P=t*A[c+16384&65535]+q*A[c&65535],q=q*A[c+16384&65535]-t*A[c&65535],P=P/f,q=q/f,q=q-h,P=P- -20,t=(1.5*r+1.5*g-100-100)/400+3*d-1;0>t&&(t=0);1<t&&(t=1);s=s*(1-t)+q*t;p=p*(1-t)+P*t;s&=127;p&=127;p=4*(128*p+s);n[l++]=j[p++];n[l++]=j[p++];n[l++]=j[p++];n[l++]=
255}Sa.putImageData(Ta,0,0);z.drawImage(V,120,56,400,400);0.95<d&&(z.fillStyle="rgba(0,0,0,"+(20*d-19).toFixed(3)+")",z.fillRect(0,0,640,512))},function(a,c,d){z.fillStyle="#000000";z.fillRect(0,0,640,512);var f=a?Xa:Wa,k=a?Va:Ua;a=a?0:60;var e=320-k.width/2;z.globalAlpha=0.9>d?1:10-10*d;for(d=0;d<f.length;++d){var h=f[d];c>h.a&&z.drawImage(k,h.x,h.y,h.j,h.i,h.x+e,2*h.y+a,h.j,2*h.i)}},function(a,c,d){z.fillStyle="#000073";z.fillRect(0,0,640,512);100<c&&(a=c/d-c,z.fillStyle="#ffffff",z.font="30px sans-serif",
z.textAlign="center",z.textBaseline="middle",z.fillText("This scene is not yet implemented...",320,256),z.font="20px sans-serif",z.fillText((a/1E3).toFixed(1)+" seconds to next implemented scene",320,296))}],Za=[{a:0,f:4700,g:0,h:0},{a:4700,f:8400,g:0,h:1},{a:8400,f:9500,g:0,h:2},{a:9500,f:4E4,g:2,h:0},{a:4E4,f:44E3,g:5,h:0},{a:44E3,f:48E3,g:5,h:1},{a:48E3,f:52E3,g:3,h:0},{a:52E3,f:56E3,g:3,h:1},{a:56E3,f:63300,g:3,h:2},{a:63300,f:82500,g:4,h:0},{a:82500,f:9E4,g:5,h:2},{a:9E4,f:94E3,g:5,h:3},{a:94E3,
f:98E3,g:6,h:0},{a:98E3,f:128500,g:6,h:1},{a:128500,f:132500,g:1,h:0},{a:132500,f:139500,g:1,h:1},{a:139500,f:147E3,g:1,h:2},{a:147E3,f:163E3,g:1,h:3},{a:163E3,f:178300,g:7,h:0},{a:178300,f:182300,g:8,h:0},{a:182300,f:188E3,g:8,h:1},u];
function $a(a){if(ka){aa=60*((a-ja)/1E3);w=a-ka;var c=Za[ma];c&&w>=c.f&&(++ma,c=Za[ma]);if(c){var d=w-c.a,f=d/(c.f-c.a);na=Ya[c.g];var k=(new Date).getTime();z.globalAlpha=1;z.save();na.call(this,c.h,d,f,aa);z.restore()}c=(22-((new Date).getTime()-k)-10*aa)/200;0<c&&(c*=0.005);c=ia+c;1<c?c=1:0.1>c&&(c=0.1);ia=c}la&&(ja||(ka=a-1E3*la),ja=a);oa&&x($a)}function ab(){oa=b;x($a)}function bb(){la=this.currentTime}var W=[],X=0;
function cb(a){W.push(a);++X;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.q=X-W.length;window.dispatchEvent(a)}function db(a){for(var c=[],d=0;d<W.length;++d)W[d]!=a&&c.push(W[d]);W=c;a=document.createEvent("Event");a.initEvent("itemsLoader",b,b);a.total=X;a.q=X-W.length;window.dispatchEvent(a)}var Y=m;function eb(){Y&&window.clearTimeout(Y);var a=this;Y=window.setTimeout(function(){Y=m;a.removeEventListener("progress",eb,u);db(a)},2E3)}
function fb(){Y&&(window.clearTimeout(Y),Y=m);this.removeEventListener("progress",eb,u);db(this)}function gb(){db(this)}function Z(a){var c=new Image;cb(c);c.addEventListener("load",gb,u);c.src=a+"?ts="+(new Date).getTime();return c}var $=m;
onLoadingDone=function(){$&&(window.clearTimeout($),$=m);for(var a=[],c=4*Math.atan(1),d=0;65535>=d;++d)a.push(Math.sin(d*c/32768));A=a;M=document.createElement("CANVAS");M.width=M.height=224;N=M.getContext("2d");za=N.createImageData(224,224);c=[];for(a=0;224>=a;++a)c.push(Math.sin(Math.acos(a/112-1)));Aa=c;a=document.createElement("CANVAS");a.width=512;a.height=512;a=a.getContext("2d");a.clearRect(0,0,512,512);a.drawImage(Ba,0,0);c=a.getImageData(0,0,512,512).data;Ca=Array(262144);for(var f=d=0;512>
f;++f)for(a=0;512>a;++a)Ca[d]=128<c[4*d],++d;Q.push({l:"#ffffff",m:"#000000",o:Da,scale:2});Q.push({l:"#000000",m:"#441010",o:Ea,scale:2});Q.push({l:"#ffffff",m:"#000000",o:Fa,scale:2});Q.push({l:"#000000",m:"#000000",o:Ga,scale:2});I=H.width;J=H.height;a=document.createElement("CANVAS");a.width=I;a.height=J;a=a.getContext("2d");a.drawImage(H,0,0,I,J);wa=a.getImageData(0,0,I,J);K=document.createElement("CANVAS");K.width=320;K.height=192;xa=K.getContext("2d");ya=xa.createImageData(320,192);L=[];for(a=
0;77>a;++a)c="    aaa bbb ccaaddddbbbbaaaacccc aaabbbdddbbbccc aa bbddddccccddbbbbabbbbcccc"[a]," "==c?L.push(u):L.push(20*(c.charCodeAt(0)-97));a=document.createElement("CANVAS");a.width=a.height=128;a=a.getContext("2d");a.drawImage(Qa,0,0);Ra=a.getImageData(0,0,128,128);V=document.createElement("CANVAS");V.width=100;V.height=100;Sa=V.getContext("2d");Ta=Sa.createImageData(100,100);pa.play()};
onItemsLoader=function(a){$&&(window.clearTimeout($),$=m);z.fillStyle="#000000";z.fillRect(0,0,640,512);z.fillStyle="#ffffff";a.q==a.total?(z.font="50px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText("Loading done!",320,256),z.font="20px sans-serif",z.fillText("Click to start...",320,296),window.setTimeout(onLoadingDone,10),ha.addEventListener("click",onLoadingDone,u)):(z.font="30px sans-serif",z.textAlign="center",z.textBaseline="middle",z.fillText("Loading...",320,256),z.font=
"20px sans-serif",z.fillText((100*(a.q/a.total)).toFixed(0)+" % done",320,296))};
onload=function(){ha=document.getElementById("demo");z=ha.getContext("2d");oa=u;window.addEventListener("itemsLoader",onItemsLoader,u);var a=document.createElement("AUDIO");a.controls=b;a.s="auto";cb(a);a.addEventListener("play",ab,u);a.addEventListener("timeupdate",bb,u);a.addEventListener("progress",eb,u);a.addEventListener("canplay",fb,u);var c=a.canPlayType("audio/ogg"),d=a.canPlayType("audio/mpeg");if("probably"==c||"maybe"==c&&"probably"!=d)a.src="livin-insanity.ogg";else if("probably"==d||
"maybe"==d)a.src="livin-insanity.mp3";a.load();pa=a;B=Z("whaaaaat.png");C=Z("biteArte.png");D=Z("deadChicken.png");O=Z("globe.png");Ba=Z("globeDoodles.png");Da=Z("sanity1.png");Ea=Z("madman.png");H=Z("tunnelBits.png");Fa=Z("einstein.png");Ga=Z("sanity2.png");Qa=Z("seventies.png");Ua=Z("hailSalvadore.png");Va=Z("trueArtists.png")};window.onload=onload;